{"ast":null,"code":"import _slicedToArray from\"/Users/zacdeng/Study/git_repo/subscript/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{initializeApp}from'firebase/app';import{useState,useEffect}from\"react\";import{getDatabase,onValue,ref,set}from'firebase/database';import{getAuth,GoogleAuthProvider,onIdTokenChanged,signInWithPopup,signOut}from'firebase/auth';var firebaseConfig={apiKey:\"AIzaSyCFyJGqXhKiI5o4i0yt1DlKD1NlITT6My4\",authDomain:\"subscript-1aa30.firebaseapp.com\",projectId:\"subscript-1aa30\",storageBucket:\"subscript-1aa30.appspot.com\",messagingSenderId:\"33642841380\",appId:\"1:33642841380:web:8102ff86c9e19b73355fb1\",measurementId:\"G-Y74360EE24\"};var firebase=initializeApp(firebaseConfig);var database=getDatabase(firebase);export var signInWithGoogle=function signInWithGoogle(){signInWithPopup(getAuth(firebase),new GoogleAuthProvider());};export var useUserState=function useUserState(){var _useState=useState(),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];useEffect(function(){onIdTokenChanged(getAuth(firebase),setUser);},[]);return[user];};var firebaseSignOut=function firebaseSignOut(){return signOut(getAuth(firebase));};export{firebaseSignOut as signOut};export var useData=function useData(path,transform){var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),data=_useState4[0],setData=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),loading=_useState6[0],setLoading=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),error=_useState8[0],setError=_useState8[1];useEffect(function(){var dbRef=ref(database,path);var devMode=!process.env.NODE_ENV||process.env.NODE_ENV==='development';if(devMode){console.log(\"loading \".concat(path));}return onValue(dbRef,function(snapshot){var val=snapshot.val();if(devMode){console.log(val);}setData(transform?transform(val):val);setLoading(false);setError(null);},function(error){setData(null);setLoading(false);setError(error);});},[path,transform]);return[data,loading,error];};export var setData=function setData(path,value){return set(ref(database,path),value);};","map":{"version":3,"sources":["/Users/zacdeng/Study/git_repo/subscript/src/utilities/firebase.js"],"names":["initializeApp","useState","useEffect","getDatabase","onValue","ref","set","getAuth","GoogleAuthProvider","onIdTokenChanged","signInWithPopup","signOut","firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","firebase","database","signInWithGoogle","useUserState","user","setUser","firebaseSignOut","useData","path","transform","data","setData","loading","setLoading","error","setError","dbRef","devMode","process","env","NODE_ENV","console","log","snapshot","val","value"],"mappings":"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","sourcesContent":["import { initializeApp } from 'firebase/app';\nimport {useState, useEffect} from \"react\";\nimport { getDatabase, onValue, ref, set } from 'firebase/database';\nimport { getAuth, GoogleAuthProvider, onIdTokenChanged, signInWithPopup, signOut } from 'firebase/auth';\n\nconst firebaseConfig = {\n    apiKey: \"AIzaSyCFyJGqXhKiI5o4i0yt1DlKD1NlITT6My4\",\n    authDomain: \"subscript-1aa30.firebaseapp.com\",\n    projectId: \"subscript-1aa30\",\n    storageBucket: \"subscript-1aa30.appspot.com\",\n    messagingSenderId: \"33642841380\",\n    appId: \"1:33642841380:web:8102ff86c9e19b73355fb1\",\n    measurementId: \"G-Y74360EE24\"\n};\n\nconst firebase = initializeApp(firebaseConfig);\nconst database = getDatabase(firebase);\n\nexport const signInWithGoogle = () => {\n    signInWithPopup(getAuth(firebase), new GoogleAuthProvider());\n};\n\nexport const useUserState = () => {\n    const [user, setUser] = useState();\n\n    useEffect(() => {\n        onIdTokenChanged(getAuth(firebase), setUser);\n    }, []);\n\n    return [user];\n};\n\nconst firebaseSignOut = () => signOut(getAuth(firebase));\n\nexport { firebaseSignOut as signOut };\n\nexport const useData = (path, transform) => {\n    const [data, setData] = useState();\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState();\n\n    useEffect(() => {\n        const dbRef = ref(database, path);\n        const devMode = !process.env.NODE_ENV || process.env.NODE_ENV === 'development';\n        if (devMode) { console.log(`loading ${path}`); }\n        return onValue(dbRef, (snapshot) => {\n            const val = snapshot.val();\n            if (devMode) { console.log(val); }\n            setData(transform ? transform(val) : val);\n            setLoading(false);\n            setError(null);\n        }, (error) => {\n            setData(null);\n            setLoading(false);\n            setError(error);\n        });\n    }, [path, transform]);\n\n    return [data, loading, error];\n};\n\nexport const setData = (path, value) => (\n    set(ref(database, path), value)\n  );\n"]},"metadata":{},"sourceType":"module"}